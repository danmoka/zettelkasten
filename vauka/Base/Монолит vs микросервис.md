08112022 1656
Tags: #z #dev

---
# Монолит vs микросервис

## Монолит
- бекенд выполняет все задачи
- фронтенд, бекенд, БД связаны воедино
- +:
    - упрощенная разработка (одна кодовая база, не думай об интеграциях)
    - упрощенное развертывание
    - поддержка и поиск неисправностей
    - лучшая производительность
- -:
    - сложность внедрения новых технологий (не получится писать на разных языках)
    - большая кодовая база (сложно входить в проект, плохие изменения могут затронуть весь монолит)
    - масштабирование отдельного функционала

## Сервис-ориентированная архитектура
- разные сервисы, которые заняты своей задачей
- у каждого есть свой интерфейс, бизнес-логика и БД
- есть шина для обмена данными
- +:
    - разбиение на сервисы (можем писать сервисы на разных языках)
    - простота развертывания и масштабирования (может масштабировать отдельный сервис на сервере с такими характеристиками, которые данному сервису нужны)
    - внедрение новых сервисов (просто подключи к шине)
- -:
    - централизованная логика (отказ работы шины - отказ работы всей системы)
    - сложно найти источник проблем

## Микросервисы
- каждая задача - отдельный сервис
- делим сервисы из SOA на небольшие функциональные бизнес куски
- +:
    - можно разрабатывать сервисы на разных языках
    - независимость сервисов (проще деплоить и масштабировать)
    - децентрализованное управление данными
    - безопасность
    - независимость команд
- -:
    - сложность проектирования и разработки
    - устранение неполадок
    - тестирование комплекса микросервисов

# Какие проблемы призваны решать микросервисы

## Рост операционных расходов

По идее микросервисы призваны уменьшить операционные расходы (расходы на поддержание инфраструктуры). Но:
Монолит:
- деплоим один и тот же монолит на несколько серверов и у всех **одинаковая конфигурация и один балансировщик нагрузки***
Микросервис:
- тысячи приложения с **разными конфигурациями, системными требованиями, инструментами деплоя**
- нужны **балансировщики нагрузки** для разных микросервисов
- нужны **новые инструменты для управления** конфигурациями
- нужно **больше рук**, которые имеет более **высокую квалификацию**

## Увеличение кодовой базы, уменьшение тех. долга

Монолит:
- **проще навигация** по коду (можно просто пройти по коду и посмотреть кто и что вызывает)
Микросервисы:
- **размазывание** тех. долга по нескольким приложениям вместо одного **не приводит к уменьшению тех. долга**
- **сложнее навигация по коду**, т.к. функция может иметь вызов другого сервиса, и нужно уже идти смотреть туда, выкачивать код с репозитория, а он вообще может быть написан на другом языке 

## Масштабирование

Монолит:
- появилась фича, увеличилась нагрузка, надо **горизонтально масштабировать весь монолит** (т.е. нужен еще сервак, который отвечает всем требованиям)
Микросервисы:
- **новая фича - новый микросервис**, можно масштабировать только под него
- множество тесно связанных микросервисов приводят к **масштабированию группы микросервисов**

# Проблемы микросервисов

## Производительность

- **увеличение время обработки** запроса при взаимодействии микросервисов
- **UX** не очень, т.к. **надо ждать**

## Доступность

- появляется **множество точек отказа** (микросервис упал, сеть не работает)
- **увеличивается вероятность НЕдоступности** сервиса по мере роста цепочки запросов
- **увеличение предполагаемого времени обработки запроса** по мере роста цепочки запросов

## Хранилища

- **много баз данных** (1 микросервис - 1 БД)
- если есть общие данные у микросервисов, то требуется поддерживать их в **актуальном состоянии** (у каждого в своей БД)
- вместо простого JOIN таблиц приходится делать **несколько запросов**, а потом в коде **объединять данные**


---
### Zero-Links
- [[00 Архитектура и дизайн ПО]]

---
### Links
- 

---
### Outer links
- [[Микросервисы, Крис Ричардсон]]