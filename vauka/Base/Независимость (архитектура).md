28112022 1250
Tags: #z #dev

---
# Независимость

Хорошая архитектура должна обеспечивать:
- множество вариантов использования системы
- простоту разработки
- простоту развертывания
- простоту сопровождения
- эффективность работы

### Варианты использования

Если система - это онлайн магазин, то система должна поддерживать все варианты использования онлайн магазина. Онлайн магазин будет виден в самой архитектуре системы.

### Эффективность работы

Если система требует поддерживать 100 000 запросов в секунду, то архитектура должна позволять это сделать. Неважно как: множество служб на одной машине, множество микро сервисов и т.д. Этот вопрос остается открытым и может меняться, главное, что эта вариативность и высоконагруженность обеспечиваются архитектурой.

### Простота разработки

Архитектура может быть поделена на службы, которые разрабатываются независимо разными командами, а может быть монолитом, который разрабатывает одна небольшая команда. Надо исходить из конкретных потребностей, учитывая, что в будущем разделение может поменяться.

### Простота развертывания

Например, интерфейс и бизнес-правила могут развертываться независимо друг от друга. Так же могут быть заданы сценарии, которые развертывают службы автоматически.

## Как разбить систему?

### По уровню

Можно разбить на горизонтальные уровни:
- уровень интерфейса
- уровень БД и языка запросов
- уровень бизнес-правил (core)
- уровень бизнес-правил (app)

У разных уровней разные причины для изменения.

### По использованию

Одна часть интерфейса может использоваться для добавления товаров в корзину, другая для оплаты товара. Можно разбить интерфейс на дополнительные части. Получается вертикальное дробление горизонтальных уровней.

## Зачем разбивать систему?

Для того, чтобы архитектура соответствовала пунктам, упомянутым в самом начале. Для этого можно применить режимы разбиения:

- уровень исходного кода (изменения в одних модулях не затрагивают другие): отсутствие синдрома следующего утра, код выполняется в одном адресном пространстве
- уровень развертывания (независимость развертывания и разработки единиц развертывания): выполнение в одном адресном пространстве, но в разных потоках/процессах
- уровень служб (независимость разработки, развертывания, команд): снижаем зависимость до уровня взаимодействия и структур данных; выполнение на одной или разных машинах

## Что выбрать?

Начать можно с разбиения на уровне исходного кода. Разбить горизонтально и вертикально, сделать модули без циклических зависимостей. Затем начинать разбивать на уровни развертывания. Почему? Может потребоваться выкатывать обновления чаще, чем для всей системы, переместить выполнение в отдельный процесс и т.д.
Далее можно смотреть на единицы развертывания как на отдельные службы. Почему? Может потребоваться большое кол-во ресурсов для работы службы и она должна жить отдельно. Служба преобразуется в отдельную систему со своей командой и т.д.

Хорошая архитектура защищает большую часть исходного кода от таких изменений. Она оставляет режим разделения открытым, поэтому для крупномасштабных вариантов развертывания может использоваться один режим, а для мелкомасштабных - другой.

---
### Zero-Links
- [[00 Архитектура и дизайн ПО]]

---
### Links
- [[Монолит vs микросервис]]

---
### Outer links
- [[Чистая архитектура, Роберт Мартин]] (с. 156)